{% block content %}
<header class="header">
    <div class="header-container">
        <h1 class="logo">Student Dashboard</h1>
        <nav class="nav">
            <ul class="nav-list">
                <li><a href="{{ url_for('student_dashboard') }}" class="nav-link">Home</a></li>
                <li><a href="{{ url_for('logout') }}" class="nav-link logout-link">Logout</a></li>
            </ul>
        </nav>
    </div>
</header>

<main class="main-content">
    <div class="dashboard-container">
        <h2>Welcome, {{ user.name }}</h2>

        <!-- Student Info Section -->
        <section class="student-info">
            <h3>Your Information</h3>
            <p><strong>Name:</strong> {{ user.name }}</p>
            <p><strong>Email:</strong> {{ user.email }}</p>
        </section>

        <!-- Display Alert if Student Exceeded Access Attempts -->
        {% if exceeded_status %}
            <div class="alert alert-danger">
                You have exceeded the allowed number of access attempts. Please contact the admin to resolve this issue.
            </div>
        {% endif %}

        <!-- View Results Button -->
        <section class="results-section">
            <h3>Academic Section</h3>
            <!-- Button triggers the fee check logic -->
            <button class="view-results-btn" onclick="checkFeesStatus()">View Results</button>
        </section>
    </div>
</main>

<style>
    body {
        margin: 0;
        font-family: Arial, sans-serif;
        background-color: #f4f4f4;
        color: #333;
    }

    .header {
        background-color: #008080;
        padding: 15px 20px;
        color: white;
        position: sticky;
        top: 0;
        z-index: 1000;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    .header-container {
        display: flex;
        justify-content: space-between;
        align-items: center;
    }

    .logo {
        font-size: 24px;
        font-weight: bold;
        margin: 0;
    }

    .nav {
        display: flex;
    }

    .nav-list {
        list-style: none;
        margin: 0;
        padding: 0;
        display: flex;
        gap: 20px;
    }

    .nav-link {
        color: white;
        text-decoration: none;
        font-size: 16px;
        transition: color 0.3s;
    }

    .nav-link:hover, .logout-link:hover {
        color: #ddd;
    }

    .main-content {
        padding: 20px;
    }

    .dashboard-container {
        background-color: white;
        padding: 40px;
        border-radius: 15px;
        box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
        max-width: 900px;
        margin: 30px auto;
        text-align: center;
    }

    .dashboard-container h2 {
        font-size: 28px;
        margin-bottom: 20px;
        color: #008080;
    }

    .student-info {
        text-align: left;
        padding: 20px;
        background-color: #f9f9f9;
        border-radius: 10px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.05);
    }

    .student-info h3 {
        color: #555;
        margin-bottom: 10px;
        font-size: 20px;
    }

    .student-info p {
        margin: 10px 0;
        font-size: 16px;
    }

    .results-section {
        margin-top: 20px;
    }

    .view-results-btn {
        background-color: #008080;
        color: white;
        border: none;
        padding: 10px 20px;
        font-size: 16px;
        border-radius: 5px;
        cursor: pointer;
        transition: background-color 0.3s ease;
    }

    .view-results-btn:hover {
        background-color: #005959;
    }

    /* Alert Styling */
    .alert {
        padding: 10px;
        margin-top: 20px;
        background-color: #f8d7da;
        color: #721c24;
        border: 1px solid #f5c6cb;
        border-radius: 5px;
    }
</style>

<script>
    function checkFeesStatus() {
        fetch('/check_fees_status', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            credentials: 'include' // Include session cookies to maintain user session
        })
        .then(response => response.json())
        .then(data => {
            if (data.status === 'success') {
                alert("You can now view your results.");
                window.location.href = "/view_results"; // Redirect to the results page
            } else if (data.status === 'warning') {
                alert(data.message); // Notify the student about unpaid fees
            } else {
                alert("An error occurred: " + data.message);
            }
        })
        .catch(error => {
            console.error('Error:', error);
            alert("An error occurred while checking your fees status. Please try again.");
        });
    }
</script>
{% endblock %}
