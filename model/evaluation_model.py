from sklearn.metrics import classification_report, accuracy_score
import pandas as pd
from src.behavior_model import load_model
from src.feature_extractor import extract_features

def evaluate_model(model_file, data):
    """
    Evaluate the performance of the trained model.
    """
    model = load_model(model_file)
    
    data = extract_features(data)  
    X = data[['hour_of_day', 'day_of_week', 'activity_type']] 
    X = pd.get_dummies(X)
    y = data['is_suspicious']

    y_pred = model.predict(X)
    print("Model Evaluation:")
    print(f"Accuracy: {accuracy_score(y, y_pred)}")
    print("Classification Report:")
    print(classification_report(y, y_pred))

if __name__ == "__main__":

    data = pd.read_csv('user_activity_data.csv')  
    evaluate_model('saved_models/behavior_model.pkl', data)
